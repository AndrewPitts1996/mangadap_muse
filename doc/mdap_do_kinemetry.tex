\subsection{{\tt mdap\_do\_kinemetry.pro}}
\label{dap_sec:mdap_do_kinemetry}

This interface module is responsible to pass the measured stellar and
emission line velocities to the kinemetry module, which measures the
rotation curves, outflows and inflows motions, mean kinematic position
angle, and mean kinematic axial ratio of stars and gas. The kinemetry
module uses the kinemetry.pro module by Kraijnovic et al. 2005
(Section \ref{dap_sec:mdap_kinemetry})

The following steps are executed:

 \begin{itemize}

  \item The galaxy image is used to determine the galaxy center. If
    the center is outside a $3''\times 3''$ box aroud the center of
    the field of view, the galaxy center is automatically set to
    (0,0), i.e. the center of the field of view. The galaxy kinematic
    center is set to be the galaxy photometric center in the
    kinemetry.pro runs.


 \item A first kinemetry run is executed, to get the The galaxy
   systemic velocity is kept constant at all radii (a first
   kinemetry.pro run is executed to measure the systemic velocities
   Vs$_i$at each i-th radius. The galaxy systemic velocity (Vsyst) and
   its 1sigma error (Vsyst\_std) are computed by the median and the
   standard deviation of the systemic velocities Vs$_i$).

 \item A second kinemetry run is executed, fixing the kinematic center
   and the systemic velocity. In this run, the kinematic position
   angles (PA$_i$) and flattening (q$_i$) are measured for each
   radius. The galaxy mean kinematic position angle (PA\_kin) and its
   error (PA\_kin\_std) are measured as the median and standard
   deviation of all the PA$_i$ previously measured.  The galaxy mean
   kinematic axial ratio (q\_kin) and its error (q\_kin\_std) are
   measured as the median and standard deviation of all the q$_i$
   previously measured.

\item A third and final kinemetry run is executed, fixing the
  kinematic center, position angle, and axial ratio determined in the
  previous runs. This last run determines the rotation velocity, and
  expansion velocity (i.e. inflows/outflows) for several radii.

\end{itemize}


Table \ref{dap_tab:mdap_do_kinemetry} lists the inputs and outputs of
the interface module mdap\_do\_kinemetry.pro.

\begin{center}
\begin{longtable}{p{2.7cm}| p{11.1cm}}
\caption{Inputs and outputs parameters of
  mdap\_do\_kinemetry.pro} \label{dap_tab:mdap_do_kinemetry}
\\ \hline \endfirsthead

\hline
\endhead

\hline
\endlastfoot

\hline 
{\bf INPUTS} & \\ 
\hline 

image & NxM array. Galaxy image. It is used to determine the location
        of the center.\\
%
x2d & NxM array. X coordinates corresponding to image (0,0 is the
     center of the field of view.\\
% 
y2d NxM array. Y coordinates corresponding to image (0,0 is the
     center of the field of view.\\
%
x & T elements array. X coordinates at which the velocites are measured. \\
%
y & T elements array. X coordinates at which the velocites are measured. \\
%
velocity & T elements array. The measured velocities (in km/sec).\\
%
velocity\_err & T elements array. The measured velocity errors (in km/sec).\\
%
\hline
{\bf OUTPUTS} & \\
\hline
PA\_kin &    Median kinematic position angle used to determine Vrot and Vexp (third kinemetry.pro run). \\ 
%
PA\_kin\_std & Standard deviation of the kinematic position angles measured in the second kinemetry run. \\
%
q\_kin &  Median kinematic axial ratio used to determine Vrot and Vexp (third kinemetry.pro run). \\ 
%
q\_kin\_std & Standard deviation of the kinematic axial ratio measured in the second kinemetry run. \ \\ 
%
Vsyst & Systemic velocity used to determine Vrot and Vexp (third kinemetry.pro run) \\ 
%
Vsyst\_std & tandard deviation of the systemic velocities determined in the first kinemetry run.\\ 
%
Rad\_kin & W elements array. Semi major axis of the ellipses where Vrot and Vexp are measured. \\ 
%
Vrot & W elements array. Rotational velocity measured at Rad\_kin. \\ 
%
Vrot\_err & W elements array. Errors on Vrot. \\ 
%
Vexp & W elements array. Outflow/Inflow velocity measured at Rad\_kin. \\ 
%
Vexp\_err & W elements array. Errors on Vexp. \\ 
%
gal\_center\_x & Float. X coordinate of the galaxy center (0,0 is the center of the field of view). \\  
%
gal\_center\_y & Float. Y coordinate of the galaxy center (0,0 is the center of the field of view).\\ 
\hline
{\bf OPTIONAL OUTPUTS}  & \\
\hline
 version  & String containin the module version. If requested, the module is not executed 
           and only version flag is returned.\\
\hline
\hline
\end{longtable}
\end{center}
