

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mangadap.config.defaults &mdash; mangadap 2.2.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="mangadap 2.2.2 documentation" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> mangadap
          

          
          </a>

          
            
            
              <div class="version">
                2.2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../mangadap.html">mangadap package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">mangadap</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>mangadap.config.defaults</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for mangadap.config.defaults</h1><div class="highlight"><pre>
<span></span><span class="c1"># Licensed under a 3-clause BSD style license - see LICENSE.rst</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Provides a set of functions that define and return defaults used by the</span>
<span class="sd">MaNGA DAP, such as paths and file names.</span>

<span class="sd">*License*:</span>
<span class="sd">    Copyright (c) 2015, SDSS-IV/MaNGA Pipeline Group</span>
<span class="sd">        Licensed under BSD 3-clause license - see LICENSE.rst</span>

<span class="sd">*Source location*:</span>
<span class="sd">    $MANGADAP_DIR/python/mangadap/config/defaults.py</span>

<span class="sd">*Imports and python version compliance*:</span>
<span class="sd">    ::</span>

<span class="sd">        from __future__ import division</span>
<span class="sd">        from __future__ import print_function</span>
<span class="sd">        from __future__ import absolute_import</span>
<span class="sd">        from __future__ import unicode_literals</span>
<span class="sd">        </span>
<span class="sd">        import sys</span>
<span class="sd">        if sys.version &gt; &#39;3&#39;:</span>
<span class="sd">            long = int</span>
<span class="sd">    </span>
<span class="sd">        import os.path</span>
<span class="sd">        from os import environ</span>
<span class="sd">        import glob</span>
<span class="sd">        import numpy</span>
<span class="sd">        from mangadap.util.exception_tools import check_environment_variable</span>

<span class="sd">*Revision history*:</span>
<span class="sd">    | **23 Apr 2015**: Original implementation by K. Westfall (KBW)</span>
<span class="sd">    | **19 May 2015**: (KBW) Documentation and Sphinx tests</span>
<span class="sd">    | **20 May 2015**: (KBW) TODO: Change the default names of the par</span>
<span class="sd">        and output fits files</span>
<span class="sd">    | **15 Jun 2015**: (KBW) Added default functions moved from</span>
<span class="sd">        :class:`mangadap.drpfile`</span>
<span class="sd">    | **16 Jun 2015**: (KBW) Added wavelength limits and lower flux</span>
<span class="sd">        limit to</span>
<span class="sd">        :func:`mangadap.config.inputdata.available_template_libraries`</span>
<span class="sd">    | **17 Jun 2015**: (KBW) Moved declarations of template library keys</span>
<span class="sd">        to its own function: *default_template_library_keys*, and</span>
<span class="sd">        edited :func:`available_template_libraries` accordingly</span>
<span class="sd">    | **27 Aug 2015**: (KBW) Changed the name of the plan file; added</span>
<span class="sd">        :func:`default_dap_file_root` based on file_root() from</span>
<span class="sd">        :class:`mangadap.survey.rundap`.</span>
<span class="sd">    | **28 Aug 2015**: (KBW) Added :func:`default_manga_fits_root` and</span>
<span class="sd">        :func:`default_cube_covariance_file`</span>
<span class="sd">    | **07 Oct 2015**: (KBW) Adjusted for changes to naming of the</span>
<span class="sd">        template library database definitions.  Added M11-STELIB-ZSOL</span>
<span class="sd">        library.</span>
<span class="sd">    | **29 Jan 2016**: (KBW) Changed</span>
<span class="sd">        :func:`manga.config.inputdata.available_template_libraries` to</span>
<span class="sd">        use configparser ini files to define each template library.</span>
<span class="sd">    | **03 Feb 2016**: (KBW) Added checks for required environmental</span>
<span class="sd">        variables.</span>
<span class="sd">    | **17 Feb 2016**: (KBW) Added try/except blocks for importing</span>
<span class="sd">        ConfigParser.</span>
<span class="sd">    | **16 Mar 2016**: (KBW) Created :mod:`mangadap.config.inputdata`</span>
<span class="sd">        and moved **default_template_libraries** there (and changed it</span>
<span class="sd">        to</span>
<span class="sd">        :func:`mangadap.config.inputdata.available_template_libraries`.</span>
<span class="sd">        No longer need ConfigParser here.</span>
<span class="sd">    | **12 Jul 2016**: (KBW) Changed :func:`default_manga_fits_root` to</span>
<span class="sd">        accommodate MAPS output name.</span>
<span class="sd">    | **05 May 2017**: (KBW) :func:`default_dap_version` returns</span>
<span class="sd">        internal version if MANGADAP_VER environmental variable is not</span>
<span class="sd">        defined.</span>
<span class="sd">    | **01 Mar 2018**: (KBW) Added :func:`default_redshift_fix_file`.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">unicode_literals</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span> <span class="o">&gt;</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span>
    <span class="n">long</span> <span class="o">=</span> <span class="nb">int</span>

<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="k">import</span> <span class="n">environ</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">from</span> <span class="nn">..util.exception_tools</span> <span class="k">import</span> <span class="n">check_environment_variable</span>
<span class="kn">from</span> <span class="nn">..util.version</span> <span class="k">import</span> <span class="n">__version__</span>

<div class="viewcode-block" id="default_idlutils_dir"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_idlutils_dir">[docs]</a><span class="k">def</span> <span class="nf">default_idlutils_dir</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the default IDLUTILS directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">check_environment_variable</span><span class="p">(</span><span class="s1">&#39;IDLUTILS_DIR&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;IDLUTILS_DIR&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="default_drp_version"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_drp_version">[docs]</a><span class="k">def</span> <span class="nf">default_drp_version</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the DRP version defined by the environmental variable</span>
<span class="sd">    MANGADRP_VER.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">check_environment_variable</span><span class="p">(</span><span class="s1">&#39;MANGADRP_VER&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;MANGADRP_VER&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="default_redux_path"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_redux_path">[docs]</a><span class="k">def</span> <span class="nf">default_redux_path</span><span class="p">(</span><span class="n">drpver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the main output path for the DRP products using the</span>
<span class="sd">    environmental variable MANGA_SPECTRO_REDUX.</span>

<span class="sd">    Args:</span>
<span class="sd">        drpver (str): (**Optional**) DRP version.  Default is to use</span>
<span class="sd">            :func:`default_drp_version`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Path to reduction directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make sure the DRP version is set</span>
    <span class="k">if</span> <span class="n">drpver</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">drpver</span> <span class="o">=</span> <span class="n">default_drp_version</span><span class="p">()</span>
    <span class="n">check_environment_variable</span><span class="p">(</span><span class="s1">&#39;MANGA_SPECTRO_REDUX&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;MANGA_SPECTRO_REDUX&#39;</span><span class="p">],</span> <span class="n">drpver</span><span class="p">)</span></div>


<div class="viewcode-block" id="default_drp_directory_path"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_drp_directory_path">[docs]</a><span class="k">def</span> <span class="nf">default_drp_directory_path</span><span class="p">(</span><span class="n">plate</span><span class="p">,</span> <span class="n">drpver</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">redux_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the exact directory path with the DRP file.</span>

<span class="sd">    Args:</span>
<span class="sd">        plate (int): Plate number</span>
<span class="sd">        drpver (str): (**Optional**) DRP version.  Default is to use</span>
<span class="sd">            :func:`default_drp_version`.</span>
<span class="sd">        redux_path (str): (**Optional**) Path to the root reduction</span>
<span class="sd">            directory.  Default is to use :func:`default_redux_path`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Path to the directory with the 3D products of the DRP</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make sure the redux path is set</span>
    <span class="k">if</span> <span class="n">redux_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">redux_path</span> <span class="o">=</span> <span class="n">default_redux_path</span><span class="p">(</span><span class="n">drpver</span><span class="o">=</span><span class="n">drpver</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">redux_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">plate</span><span class="p">),</span> <span class="s1">&#39;stack&#39;</span><span class="p">)</span></div>


<span class="c1"># TODO: Are these values kept in MANGACORE somewhere?</span>
<div class="viewcode-block" id="default_cube_pixelscale"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_cube_pixelscale">[docs]</a><span class="k">def</span> <span class="nf">default_cube_pixelscale</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the default pixel scale of the DRP CUBE files in arcsec.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">0.5</span></div>


<div class="viewcode-block" id="default_cube_width_buffer"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_cube_width_buffer">[docs]</a><span class="k">def</span> <span class="nf">default_cube_width_buffer</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the default width buffer in pixels used when regridding the</span>
<span class="sd">    DRP RSS spectra into the CUBE format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">10</span></div>


<div class="viewcode-block" id="default_cube_recenter"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_cube_recenter">[docs]</a><span class="k">def</span> <span class="nf">default_cube_recenter</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the default recentering flag used when regridding the DRP RSS</span>
<span class="sd">    spectra into the CUBE format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="default_regrid_rlim"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_regrid_rlim">[docs]</a><span class="k">def</span> <span class="nf">default_regrid_rlim</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the default limiting radius for the Gaussian kernel used when</span>
<span class="sd">    regridding the DRP RSS spectra into the CUBE format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">1.6</span></div>


<div class="viewcode-block" id="default_regrid_sigma"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_regrid_sigma">[docs]</a><span class="k">def</span> <span class="nf">default_regrid_sigma</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the default standard deviation of the Gaussian kernel used</span>
<span class="sd">    when regridding the DRP RSS spectra into the CUBE format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">0.7</span></div>


<div class="viewcode-block" id="default_dap_source"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_dap_source">[docs]</a><span class="k">def</span> <span class="nf">default_dap_source</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the root path to the DAP source directory using the</span>
<span class="sd">    environmental variable MANGADAP_DIR.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">check_environment_variable</span><span class="p">(</span><span class="s1">&#39;MANGADAP_DIR&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;MANGADAP_DIR&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="default_dap_version"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_dap_version">[docs]</a><span class="k">def</span> <span class="nf">default_dap_version</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the DAP version defined by the environmental variable</span>
<span class="sd">    MANGADAP_VER.  If that environmental variable does not exist,</span>
<span class="sd">    `mangadap.__version__` is returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">no_environ_var</span><span class="o">=</span><span class="kc">False</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">check_environment_variable</span><span class="p">(</span><span class="s1">&#39;MANGADAP_VER&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">EnvironmentError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;$MANGADAP_VER undefined in environment; returning internal version&#39;</span><span class="p">)</span>
        <span class="n">no_environ_var</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">__version__</span> <span class="k">if</span> <span class="n">no_environ_var</span> <span class="k">else</span> <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;MANGADAP_VER&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="default_analysis_path"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_analysis_path">[docs]</a><span class="k">def</span> <span class="nf">default_analysis_path</span><span class="p">(</span><span class="n">drpver</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dapver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the main output path for the DAP using the environmental</span>
<span class="sd">    variable MANGA_SPECTRO_ANALYSIS.</span>

<span class="sd">    Args:</span>
<span class="sd">        drpver (str): (**Optional**) DRP version.  Default is to use</span>
<span class="sd">            :func:`default_drp_version`.</span>
<span class="sd">        dapver (str): (**Optional**) DAP version.  Default is to use</span>
<span class="sd">            :func:`default_dap_version`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Path to analysis directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make sure the DRP version is set</span>
    <span class="k">if</span> <span class="n">drpver</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">drpver</span> <span class="o">=</span> <span class="n">default_drp_version</span><span class="p">()</span>
    <span class="c1"># Make sure the DAP version is set</span>
    <span class="k">if</span> <span class="n">dapver</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dapver</span> <span class="o">=</span> <span class="n">default_dap_version</span><span class="p">()</span>
    <span class="n">check_environment_variable</span><span class="p">(</span><span class="s1">&#39;MANGA_SPECTRO_ANALYSIS&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;MANGA_SPECTRO_ANALYSIS&#39;</span><span class="p">],</span> <span class="n">drpver</span><span class="p">,</span> <span class="n">dapver</span><span class="p">)</span></div>


<div class="viewcode-block" id="default_dap_common_path"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_dap_common_path">[docs]</a><span class="k">def</span> <span class="nf">default_dap_common_path</span><span class="p">(</span><span class="n">plate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ifudesign</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">drpver</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dapver</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">analysis_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the path to the path to the directory with data common to</span>
<span class="sd">    multiple binning schemes.</span>

<span class="sd">    Args:</span>
<span class="sd">        plate (int): (**Optional**) Plate number, for reference</span>
<span class="sd">            directory of a specific plate.</span>
<span class="sd">        ifudesign (int): (**Optional**)  IFU design number.</span>
<span class="sd">        drpver (str): (**Optional**) DRP version.  Default is to use</span>
<span class="sd">            :func:`default_drp_version`.</span>
<span class="sd">        dapver (str): (**Optional**) DAP version.  Default is to use</span>
<span class="sd">            :func:`default_dap_version`.</span>
<span class="sd">        analysis_path (str): (**Optional**) Path to the root analysis</span>
<span class="sd">            directory.  Default is to use :func:`default_analysis_path`</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Path to the directory with DAP reference files</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Raised if IFU design is provided and plate is not.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># For heirarchy, if ifudesign is given, plate must also be given</span>
    <span class="k">if</span> <span class="n">plate</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ifudesign</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;For IFU design subdirectory, must provide plate number.&#39;</span><span class="p">)</span>

    <span class="c1"># Get the main analysis path</span>
    <span class="k">if</span> <span class="n">analysis_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">analysis_path</span> <span class="o">=</span> <span class="n">default_analysis_path</span><span class="p">(</span><span class="n">drpver</span><span class="o">=</span><span class="n">drpver</span><span class="p">,</span> <span class="n">dapver</span><span class="o">=</span><span class="n">dapver</span><span class="p">)</span>

    <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">analysis_path</span><span class="p">,</span> <span class="s1">&#39;common&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">output_path</span>
    <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">plate</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">output_path</span> <span class="k">if</span> <span class="n">ifudesign</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ifudesign</span><span class="p">))</span></div>


<div class="viewcode-block" id="default_dap_method"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_dap_method">[docs]</a><span class="k">def</span> <span class="nf">default_dap_method</span><span class="p">(</span><span class="n">plan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">binned_spectra</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stellar_continuum</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">binning_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">continuum_method</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the method for a provided plan.  The name currently uses the</span>
<span class="sd">    keyword identifiers for the binned spectra and the stellar continuum</span>
<span class="sd">    models.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">plan</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plan</span><span class="p">[</span><span class="s1">&#39;bin_key&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">plan</span><span class="p">[</span><span class="s1">&#39;bin_key&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Must only provide a single plan.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plan</span><span class="p">[</span><span class="s1">&#39;continuum_key&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">plan</span><span class="p">[</span><span class="s1">&#39;continuum_key&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Must only provide a single plan.&#39;</span><span class="p">)</span>
        <span class="n">_binning_method</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">plan</span><span class="p">[</span><span class="s1">&#39;bin_key&#39;</span><span class="p">])</span>
        <span class="n">_continuum_method</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">plan</span><span class="p">[</span><span class="s1">&#39;continuum_key&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
<span class="c1">#        binning_method = &#39;None&#39; if binned_spectra is None else binned_spectra.method[&#39;key&#39;]</span>
        <span class="k">if</span> <span class="n">binned_spectra</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_binning_method</span> <span class="o">=</span> <span class="n">binned_spectra</span><span class="o">.</span><span class="n">method</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">binning_method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_binning_method</span> <span class="o">=</span> <span class="n">binning_method</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_binning_method</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>
        <span class="k">if</span> <span class="n">stellar_continuum</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_continuum_method</span> <span class="o">=</span> <span class="n">stellar_continuum</span><span class="o">.</span><span class="n">method</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">continuum_method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_continuum_method</span> <span class="o">=</span> <span class="n">continuum_method</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_continuum_method</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">-</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_binning_method</span><span class="p">,</span> <span class="n">_continuum_method</span><span class="p">)</span></div>


<div class="viewcode-block" id="default_dap_method_path"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_dap_method_path">[docs]</a><span class="k">def</span> <span class="nf">default_dap_method_path</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">plate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ifudesign</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">qa</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">drpver</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dapver</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">analysis_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the path to the designated subdirectory built using the plan</span>
<span class="sd">    key identifiers or directly using the provided method.</span>

<span class="sd">    The &quot;method&quot; identifying each plan is currently build using the</span>
<span class="sd">    keywords for the binning type and the continuum-fitting key.</span>
<span class="sd">    Nominally, the latter should include the template set used.</span>

<span class="sd">    Args:</span>
<span class="sd">        method (str): String defining the method identifier for a set of</span>
<span class="sd">            DAP output files.  These should be built using</span>
<span class="sd">            :func:`default_dap_method`.</span>
<span class="sd">        plate (int): (**Optional**) Plate number.</span>
<span class="sd">        ifudesign (int): (**Optional**)  IFU design number.</span>
<span class="sd">        qa (bool): (**Optional**) Give the path to the qa/ subdirectory</span>
<span class="sd">        ref (bool): (**Optional**) Give the path to the ref/</span>
<span class="sd">            subdirectory</span>
<span class="sd">        drpver (str): (**Optional**) DRP version.  Default is to use</span>
<span class="sd">            :func:`default_drp_version`.</span>
<span class="sd">        dapver (str): (**Optional**) DAP version.  Default is to use</span>
<span class="sd">            :func:`default_dap_version`.</span>
<span class="sd">        analysis_path (str): (**Optional**) Path to the root analysis</span>
<span class="sd">            directory.  Default is to use :func:`default_analysis_path`</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Path to the plan subdirectory</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Raised if IFU design is provided and plate is not,</span>
<span class="sd">            or if either qa or ref are true and one or both of plate and</span>
<span class="sd">            IFU design are not provided..</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># For heirarchy, if ifudesign is given, plate must also be given</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">plate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ifudesign</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">plate</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ifudesign</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Must provide both plate and ifudesign, if providing either.&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">qa</span> <span class="ow">and</span> <span class="n">ref</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot provide path for both qa and ref directory.  Pick one.&#39;</span><span class="p">)</span>

    <span class="c1"># Get the main analysis path</span>
    <span class="k">if</span> <span class="n">analysis_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">analysis_path</span> <span class="o">=</span> <span class="n">default_analysis_path</span><span class="p">(</span><span class="n">drpver</span><span class="o">=</span><span class="n">drpver</span><span class="p">,</span> <span class="n">dapver</span><span class="o">=</span><span class="n">dapver</span><span class="p">)</span>

    <span class="c1"># Build the plan subirectory</span>
    <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">analysis_path</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">output_path</span>
    <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">plate</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">ifudesign</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">qa</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ref</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">output_path</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;qa&#39;</span> <span class="k">if</span> <span class="n">qa</span> <span class="k">else</span> <span class="s1">&#39;ref&#39;</span><span class="p">))</span></div>


<div class="viewcode-block" id="default_manga_fits_root"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_manga_fits_root">[docs]</a><span class="k">def</span> <span class="nf">default_manga_fits_root</span><span class="p">(</span><span class="n">plate</span><span class="p">,</span> <span class="n">ifudesign</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the main root name for the output MaNGA fits files for a</span>
<span class="sd">    given plate/ifudesign/mode.</span>

<span class="sd">    Args:</span>
<span class="sd">        plate (int): Plate number</span>
<span class="sd">        ifudesign (int): IFU design number</span>
<span class="sd">        mode (str): (**Optional**) Mode of the output fits file.</span>
<span class="sd">            Options are: &#39;LINCUBE&#39;, &#39;LINRSS&#39;, &#39;LOGCUBE&#39;, &#39;LOGRSS&#39;, or</span>
<span class="sd">            &#39;MAPS&#39;.  Default is that no mode is included in the name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Root name for a MaNGA fits file:</span>
<span class="sd">        `manga-[PLATE]-[IFUDESIGN]-[MODE]`</span>

<span class="sd">    Raises:</span>

<span class="sd">        ValueError: Raised if mode is not a valid option.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;LINCUBE&#39;</span><span class="p">,</span> <span class="s1">&#39;LINRSS&#39;</span><span class="p">,</span> <span class="s1">&#39;LOGCUBE&#39;</span><span class="p">,</span> <span class="s1">&#39;LOGRSS&#39;</span><span class="p">,</span> <span class="s1">&#39;MAPS&#39;</span> <span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Do not understand mode=</span><span class="si">{0}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>
    <span class="k">return</span> <span class="s1">&#39;manga-</span><span class="si">{0}</span><span class="s1">-</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plate</span><span class="p">,</span> <span class="n">ifudesign</span><span class="p">)</span> <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> \
                    <span class="s1">&#39;manga-</span><span class="si">{0}</span><span class="s1">-</span><span class="si">{1}</span><span class="s1">-</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plate</span><span class="p">,</span> <span class="n">ifudesign</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span></div>


<div class="viewcode-block" id="default_dap_file_root"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_dap_file_root">[docs]</a><span class="k">def</span> <span class="nf">default_dap_file_root</span><span class="p">(</span><span class="n">plate</span><span class="p">,</span> <span class="n">ifudesign</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the root name of the MaNGA DAP parameter and script files</span>
<span class="sd">    for a given plate/ifudesign/mode.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        plate (int): Plate number</span>
<span class="sd">        ifudesign (int): IFU design number</span>
<span class="sd">        mode (str): (**Optional**) Mode of the DRP reduction; either RSS</span>
<span class="sd">            or CUBE.  If None (default), the mode is excluded from the</span>
<span class="sd">            file root.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Root name for the DAP file: `mangadap-[PLATE]-[IFUDESIGN]`</span>
<span class="sd">        or `mangadap-[PLATE]-[IFUDESIGN]-LOG[MODE]`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s1">&#39;mangadap-</span><span class="si">{0}</span><span class="s1">-</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plate</span><span class="p">,</span> <span class="n">ifudesign</span><span class="p">)</span> <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> \
                    <span class="s1">&#39;mangadap-</span><span class="si">{0}</span><span class="s1">-</span><span class="si">{1}</span><span class="s1">-LOG</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plate</span><span class="p">,</span> <span class="n">ifudesign</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span></div>


<div class="viewcode-block" id="default_dap_par_file"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_dap_par_file">[docs]</a><span class="k">def</span> <span class="nf">default_dap_par_file</span><span class="p">(</span><span class="n">plate</span><span class="p">,</span> <span class="n">ifudesign</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">partype</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="n">drpver</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dapver</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">analysis_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">directory_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the full path to a par file used by the DAP to analyze the</span>
<span class="sd">    specified DRP output file.</span>

<span class="sd">    Args:</span>
<span class="sd">        plate (int): Plate number</span>
<span class="sd">        ifudesign (int): IFU design number</span>
<span class="sd">        mode (str): Mode of the DRP reduction; either RSS or CUBE</span>
<span class="sd">        partype (str):  An &quot;unregulated&quot; type for the parameter file.</span>
<span class="sd">            The default is ``&#39;input&#39;``, signifying the input set of</span>
<span class="sd">            observational parameters; see</span>
<span class="sd">            :class:`mangadap.par.obsinput.ObsInputPar`.</span>
<span class="sd">        drpver (str): (**Optional**) DRP version.  Default is to use</span>
<span class="sd">            :func:`default_drp_version`.</span>
<span class="sd">        dapver (str): (**Optional**) DAP version.  Default is to use</span>
<span class="sd">            :func:`default_dap_version`.</span>
<span class="sd">        analysis_path (str): (**Optional**) Path to the root analysis</span>
<span class="sd">            directory.  Default is to use :func:`default_analysis_path`</span>
<span class="sd">        directory_path (str): (**Optional**) Path to the directory with</span>
<span class="sd">            the DAP output files.  Default is to use</span>
<span class="sd">            :func:`default_dap_common_path`</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Full path to the DAP par file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make sure the directory path is defined</span>
    <span class="k">if</span> <span class="n">directory_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">directory_path</span> <span class="o">=</span> <span class="n">default_dap_common_path</span><span class="p">(</span><span class="n">plate</span><span class="o">=</span><span class="n">plate</span><span class="p">,</span> <span class="n">ifudesign</span><span class="o">=</span><span class="n">ifudesign</span><span class="p">,</span>
                                                 <span class="n">drpver</span><span class="o">=</span><span class="n">drpver</span><span class="p">,</span> <span class="n">dapver</span><span class="o">=</span><span class="n">dapver</span><span class="p">,</span>
                                                 <span class="n">analysis_path</span><span class="o">=</span><span class="n">analysis_path</span><span class="p">)</span>
    <span class="c1"># Set the name of the par file; put this in its own function?</span>
    <span class="n">par_file</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">-</span><span class="si">{1}</span><span class="s1">.par&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">default_dap_file_root</span><span class="p">(</span><span class="n">plate</span><span class="p">,</span> <span class="n">ifudesign</span><span class="p">,</span> <span class="n">mode</span><span class="p">),</span> <span class="n">partype</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory_path</span><span class="p">,</span> <span class="n">par_file</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="default_dap_plan_file"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_dap_plan_file">[docs]</a><span class="k">def</span> <span class="nf">default_dap_plan_file</span><span class="p">(</span><span class="n">drpver</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dapver</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">analysis_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the full path to the DAP plan file.</span>

<span class="sd">    Args:</span>
<span class="sd">        drpver (str): (**Optional**) DRP version.  Default is to use</span>
<span class="sd">            :func:`default_drp_version`.</span>
<span class="sd">        dapver (str): (**Optional**) DAP version.  Default is to use</span>
<span class="sd">            :func:`default_dap_version`.</span>
<span class="sd">        analysis_path (str): (**Optional**) Path to the root analysis</span>
<span class="sd">            directory.  Default is to use :func:`default_analysis_path`</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Full path to the DAP plan file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the main analysis path</span>
    <span class="k">if</span> <span class="n">dapver</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dapver</span> <span class="o">=</span> <span class="n">default_dap_version</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">analysis_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">analysis_path</span> <span class="o">=</span> <span class="n">default_analysis_path</span><span class="p">(</span><span class="n">drpver</span><span class="o">=</span><span class="n">drpver</span><span class="p">,</span> <span class="n">dapver</span><span class="o">=</span><span class="n">dapver</span><span class="p">)</span>
    
    <span class="c1"># Set the name of the plan file</span>
    <span class="n">plan_file</span> <span class="o">=</span> <span class="s1">&#39;mangadap-plan-</span><span class="si">{0}</span><span class="s1">.par&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dapver</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">analysis_path</span><span class="p">,</span> <span class="n">plan_file</span><span class="p">)</span></div>


<div class="viewcode-block" id="default_dap_file_name"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_dap_file_name">[docs]</a><span class="k">def</span> <span class="nf">default_dap_file_name</span><span class="p">(</span><span class="n">plate</span><span class="p">,</span> <span class="n">ifudesign</span><span class="p">,</span> <span class="n">output_mode</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">compressed</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the name of the DAP output fits file.</span>

<span class="sd">    Args:</span>
<span class="sd">        plate (int): Plate number</span>
<span class="sd">        ifudesign (int): IFU design number</span>
<span class="sd">        output_mode (str) : Output mode designation</span>
<span class="sd">        mode (str): (**Optional**) Mode of the output fits file.</span>
<span class="sd">            Options are: &#39;LINCUBE&#39;, &#39;LINRSS&#39;, &#39;LOGCUBE&#39;, &#39;LOGRSS&#39;, or</span>
<span class="sd">            &#39;MAPS&#39;.  Default is that no mode is included in the name.</span>
<span class="sd">        compressed (bool): (**Optional**) Append &#39;.gz&#39; to the output</span>
<span class="sd">            file name.  Default is True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Name of the DAP output file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Number of spaces provided for iteration number is 3</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">default_manga_fits_root</span><span class="p">(</span><span class="n">plate</span><span class="p">,</span> <span class="n">ifudesign</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">-</span><span class="si">{1}</span><span class="s1">.fits.gz&#39;</span> <span class="k">if</span> <span class="n">compressed</span> <span class="k">else</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">-</span><span class="si">{1}</span><span class="s1">.fits&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">output_mode</span><span class="p">)</span></div>


<div class="viewcode-block" id="default_plate_target_files"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_plate_target_files">[docs]</a><span class="k">def</span> <span class="nf">default_plate_target_files</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the default plateTarget files in mangacore and their</span>
<span class="sd">    associated catalog indices.  The catalog indices are determined</span>
<span class="sd">    assuming the file names are of the form::</span>

<span class="sd">        &#39;plateTargets-{0}.par&#39;.format(catalog_id)</span>

<span class="sd">    Returns:</span>
<span class="sd">        numpy.array: Two arrays: the first contains the identified</span>
<span class="sd">        plateTargets files found using the default search string, the</span>
<span class="sd">        second provides the integer catalog index determined for each</span>
<span class="sd">        file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Default search string</span>
    <span class="n">check_environment_variable</span><span class="p">(</span><span class="s1">&#39;MANGACORE_DIR&#39;</span><span class="p">)</span>
    <span class="n">search_str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;MANGACORE_DIR&#39;</span><span class="p">],</span> <span class="s1">&#39;platedesign&#39;</span><span class="p">,</span> <span class="s1">&#39;platetargets&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;plateTargets*.par&#39;</span><span class="p">)</span>
    <span class="n">file_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">search_str</span><span class="p">)</span>                       <span class="c1"># List of files</span>
    <span class="n">nfiles</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_list</span><span class="p">)</span>
    <span class="n">trgid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nfiles</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>            <span class="c1"># Array to hold indices</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nfiles</span><span class="p">):</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="n">file_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>                 <span class="c1"># Strip out the &#39;{i}.par&#39;</span>
        <span class="n">trgid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">suffix</span><span class="p">[:</span><span class="n">suffix</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)])</span>           <span class="c1"># Strip out &#39;{i}&#39;</span>
    
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">file_list</span><span class="p">),</span> <span class="n">trgid</span></div>


<div class="viewcode-block" id="default_redshift_fix_file"><a class="viewcode-back" href="../../../mangadap.config.defaults.html#mangadap.config.defaults.default_redshift_fix_file">[docs]</a><span class="k">def</span> <span class="nf">default_redshift_fix_file</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the path to the default redshift fix file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Expected path to the redshift-fix parameter file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Default search string</span>
    <span class="n">check_environment_variable</span><span class="p">(</span><span class="s1">&#39;MANGADAP_DIR&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;MANGADAP_DIR&#39;</span><span class="p">],</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;fix&#39;</span><span class="p">,</span> <span class="s1">&#39;redshift_fix.par&#39;</span><span class="p">)</span></div>

</pre></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, SDSS-IV/MaNGA Pipeline Group.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'2.2.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>