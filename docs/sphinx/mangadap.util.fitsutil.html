

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mangadap.util.fitsutil module &mdash; mangadap 2.2.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="mangadap 2.2.2 documentation" href="index.html"/>
        <link rel="up" title="mangadap.util package" href="mangadap.util.html"/>
        <link rel="next" title="mangadap.util.geometry module" href="mangadap.util.geometry.html"/>
        <link rel="prev" title="mangadap.util.filter module" href="mangadap.util.filter.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> mangadap
          

          
          </a>

          
            
            
              <div class="version">
                2.2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="mangadap.html">mangadap package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="mangadap.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="mangadap.config.html">mangadap.config package</a></li>
<li class="toctree-l3"><a class="reference internal" href="mangadap.contrib.html">mangadap.contrib package</a></li>
<li class="toctree-l3"><a class="reference internal" href="mangadap.par.html">mangadap.par package</a></li>
<li class="toctree-l3"><a class="reference internal" href="mangadap.proc.html">mangadap.proc package</a></li>
<li class="toctree-l3"><a class="reference internal" href="mangadap.survey.html">mangadap.survey package</a></li>
<li class="toctree-l3"><a class="reference internal" href="mangadap.tests.html">mangadap.tests package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="mangadap.util.html">mangadap.util package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="mangadap.util.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="mangadap.util.html#module-mangadap.util">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mangadap.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mangadap.html#module-mangadap">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mangadap</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="mangadap.html">mangadap package</a> &raquo;</li>
        
          <li><a href="mangadap.util.html">mangadap.util package</a> &raquo;</li>
        
      <li>mangadap.util.fitsutil module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/mangadap.util.fitsutil.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-mangadap.util.fitsutil">
<span id="mangadap-util-fitsutil-module"></span><h1>mangadap.util.fitsutil module<a class="headerlink" href="#module-mangadap.util.fitsutil" title="Permalink to this headline">¶</a></h1>
<p>Defines a class with common functions for MaNGA fits files.  This class
needs to be as core as possible (little to no dependencies are
higher-level classes).</p>
<dl class="docutils">
<dt><em>License</em>:</dt>
<dd><dl class="first last docutils">
<dt>Copyright (c) 2016, SDSS-IV/MaNGA Pipeline Group</dt>
<dd>Licensed under BSD 3-clause license - see LICENSE.rst</dd>
</dl>
</dd>
<dt><em>Source location</em>:</dt>
<dd>$MANGADAP_DIR/python/mangadap/util/fitsutil.py</dd>
<dt><em>Imports and python version compliance</em>:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">absolute_import</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span> <span class="o">&gt;</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span>
    <span class="n">long</span> <span class="o">=</span> <span class="nb">int</span>

<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">fits</span>
<span class="kn">import</span> <span class="nn">astropy.constants</span>
</pre></div>
</div>
</dd>
<dt><em>Class usage examples</em>:</dt>
<dd>Add some usage comments here!</dd>
<dt><em>Revision history</em>:</dt>
<dd><div class="first last line-block">
<div class="line"><strong>17 May 2016</strong>: Original implementation by K. Westfall (KBW)</div>
<div class="line"><strong>02 Dec 2016</strong>: (KBW) Added
<a class="reference internal" href="#mangadap.util.fitsutil.DAPFitsUtil.reconstruct_cube" title="mangadap.util.fitsutil.DAPFitsUtil.reconstruct_cube"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.util.fitsutil.DAPFitsUtil.reconstruct_cube()</span></code></a></div>
<div class="line"><strong>23 Feb 2016</strong>: (KBW) Added functionality that deals with the
transpose of the data arrays provided by astropy.io.fits.</div>
</div>
</dd>
</dl>
<dl class="class">
<dt id="mangadap.util.fitsutil.DAPFitsUtil">
<em class="property">class </em><code class="descclassname">mangadap.util.fitsutil.</code><code class="descname">DAPFitsUtil</code><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>An abstract class that only implements a set of static methods for
interaction with MaNGA fits files.</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Make this a base class for all the fits files used/created by
the DAP?</li>
<li>Use HDUList as a base class for this object?</li>
</ul>
</div>
<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil._mask_data_type">
<em class="property">static </em><code class="descname">_mask_data_type</code><span class="sig-paren">(</span><em>bit_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil._mask_data_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil._mask_data_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.add_channel_names">
<em class="property">static </em><code class="descname">add_channel_names</code><span class="sig-paren">(</span><em>hdr</em>, <em>names</em>, <em>units=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.add_channel_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.add_channel_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.build_cube_header">
<em class="property">static </em><code class="descname">build_cube_header</code><span class="sig-paren">(</span><em>drpf</em>, <em>author</em>, <em>maskname=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.build_cube_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.build_cube_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.build_map_header">
<em class="property">static </em><code class="descname">build_map_header</code><span class="sig-paren">(</span><em>drpf</em>, <em>author</em>, <em>multichannel=False</em>, <em>maskname=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.build_map_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.build_map_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.clean_cube_header">
<em class="property">static </em><code class="descname">clean_cube_header</code><span class="sig-paren">(</span><em>hdr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.clean_cube_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.clean_cube_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.clean_dap_primary_header">
<em class="property">static </em><code class="descname">clean_dap_primary_header</code><span class="sig-paren">(</span><em>hdr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.clean_dap_primary_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.clean_dap_primary_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.clean_map_header">
<em class="property">static </em><code class="descname">clean_map_header</code><span class="sig-paren">(</span><em>hdr</em>, <em>multichannel=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.clean_map_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.clean_map_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.copy_to_array">
<em class="property">static </em><code class="descname">copy_to_array</code><span class="sig-paren">(</span><em>hdu</em>, <em>ext='FLUX'</em>, <em>allowed_ext=None</em>, <em>waverange=None</em>, <em>select_bins=None</em>, <em>missing_bins=None</em>, <em>nbins=None</em>, <em>unique_bins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.copy_to_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.copy_to_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of the selected data array.  The array size is
always <span class="math notranslate nohighlight">\(N_{\rm spec} \times N_{\rm wavelength}\)</span>; i.e., the
CUBE files are flattened to two dimensions, matching the
dimensionality of the RSS files.  The spatial positions within
the original DRP file for each spectrum are given by tuples in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">spatial_index</span></code>.  See <a class="reference internal" href="#mangadap.util.fitsutil.DAPFitsUtil.copy_to_masked_array" title="mangadap.util.fitsutil.DAPFitsUtil.copy_to_masked_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">copy_to_masked_array()</span></code></a> for
arguments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A 2D array with a copy of the data from the
selected extension.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.copy_to_masked_array">
<em class="property">static </em><code class="descname">copy_to_masked_array</code><span class="sig-paren">(</span><em>hdu</em>, <em>ext='FLUX'</em>, <em>mask_ext=None</em>, <em>flag=None</em>, <em>bitmask=None</em>, <em>allowed_ext=None</em>, <em>waverange=None</em>, <em>select_bins=None</em>, <em>missing_bins=None</em>, <em>nbins=None</em>, <em>unique_bins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.copy_to_masked_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.copy_to_masked_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of the selected data array as a masked array.
This is functionally identical to <code class="xref py py-func docutils literal notranslate"><span class="pre">DRPFits.copy_to_array()</span></code>,
except the output format is a <a class="reference external" href="http://docs.scipy.org/doc/numpy-1.10.1/reference/maskedarray.baseclass.html#numpy.ma.MaskedArray">numpy.ma.MaskedArray</a>.  The
pixels that are considered to be masked can be specified using
the <cite>flag</cite> option.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>waverange</strong> (<em>array-like</em>) – (<strong>Optional</strong>) Two-element array
with the first and last wavelength to include in the
computation.  Default is to use the full wavelength
range.</li>
<li><strong>ext</strong> (<em>str</em>) – (<strong>Optional</strong>) Name of the extension from which
to draw the data.  Must be allowed for the current
<code class="xref py py-attr docutils literal notranslate"><span class="pre">mode</span></code>; see <code class="xref py py-attr docutils literal notranslate"><span class="pre">spectral_arrays</span></code>.  Default is
<cite>‘FLUX’</cite>.</li>
<li><strong>mask_ext</strong> (<em>str</em>) – (<strong>Optional</strong>) Name of the extension with
the mask bit data.  Must be allowed for the current
<code class="xref py py-attr docutils literal notranslate"><span class="pre">mode</span></code>; see <code class="xref py py-attr docutils literal notranslate"><span class="pre">spectral_arrays</span></code>.  Default is
<cite>‘MASK’</cite>.</li>
<li><strong>flag</strong> (<em>str</em><em> or </em><em>list</em>) – (<strong>Optional</strong>) (List of) Flag names that
are considered when deciding if a pixel should be
masked.  The names <em>must</em> be a valid bit name as defined
by the provided bitmask (see
<a class="reference internal" href="mangadap.util.bitmask.html#mangadap.util.bitmask.BitMask" title="mangadap.util.bitmask.BitMask"><code class="xref py py-class docutils literal notranslate"><span class="pre">mangadap.util.bitmask.BitMask</span></code></a>).  If not
provided, <em>ANY</em> non-zero mask bit is omitted.</li>
<li><strong>bitmask</strong> (<a class="reference internal" href="mangadap.util.bitmask.html#mangadap.util.bitmask.BitMask" title="mangadap.util.bitmask.BitMask"><code class="xref py py-class docutils literal notranslate"><span class="pre">mangadap.util.bitmask.BitMask</span></code></a>) – (<strong>Optional</strong>) BitMask object used to determine if pixel
is flagged as being masked by a specific maskbit.</li>
<li><strong>allowed_ext</strong> (<em>array-like</em>) – (<strong>Optional</strong>) List of allowed
extenstions that can be copied to an array; the mask
extension <strong>must</strong> be one of these.</li>
<li><strong>waverange</strong> – (<strong>Optional</strong>) A two-element
array with the valid wavelength range.  Anything outside
of this range is masked.</li>
<li><strong>select_bins</strong> (<em>array-like</em>) – (<strong>Optional</strong>) A list of spectra
in the flattened cube (with shape <span class="math notranslate nohighlight">\(N_{\rm spec}
\times N_\lambda\)</span>) to return.</li>
<li><strong>missing_bins</strong> (<em>list</em>) – (<strong>Optional</strong>) A list of bin numbers
that are missing from the output selection and that will
be replaced with masked spectra.</li>
<li><strong>nbins</strong> (<em>int</em>) – (<strong>Optional</strong>) The total number of defined
bins.  Default is to find the maximum number in the
unique_bins list.</li>
<li><strong>unique_bins</strong> (<em>array-like</em>) – (<strong>Optional</strong>) The indices of the
bins that have valid spectra.  The length of this array
should match the selected_bins array.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A 2D array with a copy of the data from the
selected extension.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">numpy.ndarray</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyError</span></code> – Raised if <cite>ext</cite> is not a valid extension.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.downselect_bins">
<em class="property">static </em><code class="descname">downselect_bins</code><span class="sig-paren">(</span><em>bin_indx</em>, <em>good_bins</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.downselect_bins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.downselect_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace values in bin_indx with -1 if they are not in good_bins.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.empty_hdus">
<em class="property">static </em><code class="descname">empty_hdus</code><span class="sig-paren">(</span><em>ext</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.empty_hdus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.empty_hdus" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.finalize_dap_header">
<em class="property">static </em><code class="descname">finalize_dap_header</code><span class="sig-paren">(</span><em>hdr</em>, <em>ext</em>, <em>bunit=None</em>, <em>hduclas2='DATA'</em>, <em>err=False</em>, <em>qual=False</em>, <em>multichannel=False</em>, <em>bit_type=None</em>, <em>prepend=True</em>, <em>channel_names=None</em>, <em>channel_units=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.finalize_dap_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.finalize_dap_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.get_spatial_shape">
<em class="property">static </em><code class="descname">get_spatial_shape</code><span class="sig-paren">(</span><em>shape</em>, <em>dispaxis</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.get_spatial_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.get_spatial_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the shape of the spatial axes given the specified
dispersion axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>shape</strong> (<em>tuple</em>) – Shape of the full numpy.ndarray object.</li>
<li><strong>dispaxis</strong> (<em>int</em>) – Axis with the spectra.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Shape of the remaining axes.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.initialize_dap_primary_header">
<em class="property">static </em><code class="descname">initialize_dap_primary_header</code><span class="sig-paren">(</span><em>drpf</em>, <em>maskname=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.initialize_dap_primary_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.initialize_dap_primary_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.list_of_image_hdus">
<em class="property">static </em><code class="descname">list_of_image_hdus</code><span class="sig-paren">(</span><em>data</em>, <em>hdr</em>, <em>ext</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.list_of_image_hdus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.list_of_image_hdus" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.marginalize_mask">
<em class="property">static </em><code class="descname">marginalize_mask</code><span class="sig-paren">(</span><em>mask</em>, <em>inp_flags</em>, <em>inp_bitmask</em>, <em>out_bitmask</em>, <em>out_mask=None</em>, <em>out_flag=None</em>, <em>dispaxis=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.marginalize_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.marginalize_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.match_image_naxis">
<em class="property">static </em><code class="descname">match_image_naxis</code><span class="sig-paren">(</span><em>hdu</em>, <em>ext=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.match_image_naxis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.match_image_naxis" title="Permalink to this definition">¶</a></dt>
<dd><p>Match the NAXISn header keywords to the shape of the image data.
That is, reset the header keywrods such that the shape of the
data array is (NAXIS1, NAXIS2, NAXIS3, …).</p>
<p>Note that any reordering of the NAXISn keywords will <em>not</em>
change the WCS information.  You will have to account for if you
need the WCS information.</p>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">If a WCS is detected, use WCS.swapaxes() to transpose the
WCS system!</p>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.read">
<em class="property">static </em><code class="descname">read</code><span class="sig-paren">(</span><em>ofile</em>, <em>permissions='readonly'</em>, <em>checksum=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.read" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.reconstruct_cube">
<em class="property">static </em><code class="descname">reconstruct_cube</code><span class="sig-paren">(</span><em>cube_shape</em>, <em>bin_indx</em>, <em>arr</em>, <em>dtype=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.reconstruct_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.reconstruct_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstruct a set of cubes with the specified shape based on a
set of input 2D arrays.  The cube shape is expected to be
<span class="math notranslate nohighlight">\((N_x,N_y,N_\lamba)\)</span> and the array shapes are expected to
be <span class="math notranslate nohighlight">\((N_{\rm spec},N_\lambda)\)</span>, where <span class="math notranslate nohighlight">\(N_{\rm spec}\)</span>
does <em>not</em> have to match the number of unique bins.  The
bin_indx array is expected to be a vector with length
<span class="math notranslate nohighlight">\(N_x\timesN_y\)</span>.</p>
<p>The data type of the output arrays is set by the input type if
the provided dtype is None; otherwise, the code attempts to case
each output cube accordint to each element of dtype.</p>
<p>Returns a tuple if the number of arrays is larger than one so
that they can be caught by individual variables.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.reconstruct_map">
<em class="property">static </em><code class="descname">reconstruct_map</code><span class="sig-paren">(</span><em>map_shape</em>, <em>bin_indx</em>, <em>arr</em>, <em>dtype=None</em>, <em>quiet=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.reconstruct_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.reconstruct_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstruct a set of maps with the specified shape based on a
set of input 1D arrays.  The map shape is expected to be
<span class="math notranslate nohighlight">\((N_x,N_y)\)</span> and the array shapes are expected to be
<span class="math notranslate nohighlight">\((N_{\rm pix},)\)</span>, where <span class="math notranslate nohighlight">\(N_{\rm pix}\)</span> does <em>not</em>
have to match the number of unique bins.  The bin_indx array is
expected to be a vector with length <span class="math notranslate nohighlight">\(N_x\timesN_y\)</span>.</p>
<p>The data type of the output arrays is set by the input type if
the provided dtype is None; otherwise, the code attempts to case
each output map according to each element of dtype.</p>
<p>Returns a tuple if the number of arrays is larger than one so
that they can be caught by individual variables.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.redshift_to_Newtonian_velocity">
<em class="property">static </em><code class="descname">redshift_to_Newtonian_velocity</code><span class="sig-paren">(</span><em>v</em>, <em>redshift</em>, <em>ivar=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.redshift_to_Newtonian_velocity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.redshift_to_Newtonian_velocity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.storage_mode_options">
<em class="property">static </em><code class="descname">storage_mode_options</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.storage_mode_options"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.storage_mode_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the allowed storage modes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">List of the allowed storage mode for DAP fits files.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.transpose_image_data">
<em class="property">static </em><code class="descname">transpose_image_data</code><span class="sig-paren">(</span><em>hdu</em>, <em>ext=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.transpose_image_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.transpose_image_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Transpose all image data in an HDUList.</p>
<p>The primary use of this function is to ensure the HDUList data
arrays use C-contiguous memory but with the natural array
ordering of the axes that follow the NAXIS keywords in the
header.  I.e., data arrays provided by astropy.io.fits have
shapes like (…, NAXIS3, NAXIS2, NAXIS1).  This function
reorders the data arrays to have shapes like (NAXIS1, NAXIS2,
NAXIS3, …), and ensures that the NAXISn header keywords
reflect this.  Typically, one would do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hdu</span> <span class="o">=</span> <span class="n">transpose_image_data</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;test.fits&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>To prepare the image data for writing to a new fits file, one
would do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">transpose_image_data</span><span class="p">(</span><span class="n">hdu</span><span class="p">)</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;new.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you just want to ensure that the NAXISn keywords refect the
python native ordering, then use <a class="reference internal" href="#mangadap.util.fitsutil.DAPFitsUtil.match_image_naxis" title="mangadap.util.fitsutil.DAPFitsUtil.match_image_naxis"><code class="xref py py-func docutils literal notranslate"><span class="pre">match_image_naxis()</span></code></a>.</p>
<p>Note that any WCS information will <strong>not</strong> be transposed, which
you will have to account for if you need the WCS information.</p>
<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<p class="last">If a WCS is detected, use WCS.swapaxes() to transpose the
WCS system!</p>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.unique_bins">
<em class="property">static </em><code class="descname">unique_bins</code><span class="sig-paren">(</span><em>bin_indx</em>, <em>return_index=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.unique_bins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.unique_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the unique bins and the indices of the unique bins in the
flattened spatial dimension, ignoring the bins with indices of
-1.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="mangadap.util.fitsutil.DAPFitsUtil.write">
<em class="property">static </em><code class="descname">write</code><span class="sig-paren">(</span><em>hdu</em>, <em>ofile</em>, <em>clobber=False</em>, <em>checksum=False</em>, <em>symlink_dir=None</em>, <em>relative_symlink=True</em>, <em>loggers=None</em>, <em>quiet=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/util/fitsutil.html#DAPFitsUtil.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.util.fitsutil.DAPFitsUtil.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an HDUList to an output file.  It is expected that the hdu
was either read by the <a class="reference internal" href="#mangadap.util.fitsutil.DAPFitsUtil.read" title="mangadap.util.fitsutil.DAPFitsUtil.read"><code class="xref py py-func docutils literal notranslate"><span class="pre">read()</span></code></a> function, or that the hdu
was passed through <a class="reference internal" href="#mangadap.util.fitsutil.DAPFitsUtil.transpose_image_data" title="mangadap.util.fitsutil.DAPFitsUtil.transpose_image_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">transpose_image_data()</span></code></a> such that
HDUList data arrays use C-contiguous memory but with the natural
array ordering of the axes that follow the NAXIS keywords in the
header.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mangadap.util.geometry.html" class="btn btn-neutral float-right" title="mangadap.util.geometry module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mangadap.util.filter.html" class="btn btn-neutral" title="mangadap.util.filter module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, SDSS-IV/MaNGA Pipeline Group.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.2.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>