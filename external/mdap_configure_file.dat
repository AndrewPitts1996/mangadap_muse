#---------------------
# List of galaxies to process and their properties ASCII file, one
# line per galaxy, format:
#    Col 1. [string] Name of the fits file, WITHOUT the .fits extension
#    Col 2. [float]  Galaxy mean velocity (km/sec)
#    Col 3. [float]  Galaxy mean velocity dispersion (km/sec)
#    Col 4. [float]  Galaxy mean ellipticity
#    Col 5. [float]  Galaxy mean Position Angle
#    Col 6. [float]  MANGA Bundle size
#    Col 7. [float]  Galaxy effective radius
#    Col 8. [string] Dataformat. Valid entries are: datacubes or rss
#
total_filelist = './partial_filelist.dat' 
#----------------------
#
# ----------------------------------
# Location of input files and result storage
#
# depending on the dataformat (datacubes or rss) files are read from
#          datacube_root_dir+<dataformat>+'/' 
# and stored in 
#          output_root_dir+'results_'+<dataformat>+'/'
#
datacube_root_dir='../'
output_root_dir='./'
#----------------------
#
#------------------------------- 
# Wavelength range for computation of Signal-to-Noise
# r-band is ~[6251.-1382./2., 6251.+1382./2.] (Fukugita et al. 1998)
# Units: angstrom, values: float
#
# Comment the line to let the variable undefined and use the entire wavelength range.
#
w_range_for_sn_computation = [5560.00, 6942.00]
#
# You can specify a differen lambda range to compute the signal and noise for the emission line science.
# If defined, the wavelength rage will be redshifted to match the galaxy systemic velocity (taken from the starting guess)
# If not defined, the w_range_for_sn_computation_for_gas will be set as w_range_for_sn_computation, with no redshift applied
#
# This examples uses the region around Halpha+NII
# w_range_for_sn_computation_for_gas = [6530.,6600.]
#------------------------------- 
#
# Wavelength range to consider for the analysis. Galaxy spectra will be trimmed according to 
# the defined wavelength range; stellar template spectra will be trimmed +/- 200 angstrom more.
# Comment the lines to let the variables undefined and use the entire wavelength range.
# Units: angstrom, values: float
# trim_wav_range_spatial_binning_N will be passed to mdap_log_rebin via the wave_range keyword
# trim_wav_range_radial_binning_N will be passed to mdap_spatial_radial_binning via the 
# output_lrange keyword
#
trim_wav_range_spatial_binning_1 = [3650.,10300.] 
trim_wav_range_spatial_binning_2 = [3650.,7500.]
trim_wav_range_spatial_binning_3 = [3600.,10220.]
trim_wav_range_radial_binning = [3700.,9980.]
#
#------------------------------- 
#
#
#------------------------------- 
# Velocity scale (km/sec/pixel), values: float
# Comment the line to let the variable undefined and use the automatic value given by the data.
velscale = 30.
#
#
#-------------------------------

# Stellar library
# String indicating where to find the stellar (or ssp) templates for the spectral fitting.
# Tip: files will be selected via res = file_search(stellar_library_spatial_binning_N)
# Warning: stellar_library_spatial_binning_1 will be used also for the radial binning scheme.
#
# Files in the library must be fits files covering a wavelenght range
# preferentially larger than the MANGA (3000< \lambda < 10000). They
# must have an uniform angstrom/pixel sampling. The following header
# keywords need to be present: CRVAL1 (value at reference pixel), CRPIX1
# (reference pixel), and CDELT1 (dispersion in angstrom/pixel).
#
stellar_library_spatial_binning_1='./mangadap/external/templates_marcs/*fits'
stellar_library_spatial_binning_2='./mangadap/external/templates_marcs/*fits'
stellar_library_spatial_binning_3='./mangadap/external/templates_marcs/*fits'
#-------------------------------
#
#--------------------------------------------------------------------------------------------
# Target S/N ratios, S/N cut-off thresholds, and coefficient for empirical S/N calibration
# for the 3 spatial binning schemes and data format (datacubes or rss)
# Target S/N MUST be specified.
# If S/N cut-off thresholds are undefined, the default value (0) will be used. To disable 
# any S/N cut-off, set the variable to a very low (negaitve) number, e.g. -10000.
#
# If the calibration coefficients are not defined, no calbiration is performed (suggested for RSS files)
#
# S/N are intended per pixel and within the wavelength region specified by w_range_for_sn_computation (see above).
# 
#   target S/N for rss files, spatial binning 1-3:
sn1_rss = 15.
sn2_rss = 10.
sn3_rss = 5  
#   S/N threshold for rss files, spatial binning 1-3:
sn_thr_tpl_rss = -200.
sn_thr_str_rss = -200.
sn_thr_ems_rss = -200.
# Calibration coefficients for rss files. Formula is specified in the mdap_calibrat_sn.pro function.
#sn_calibration_rss = undefined
#
#   target S/N for datacubes files, spatial binning 1-3:
sn1_datacubes = 40.
sn2_datacubes = 25.
sn3_datacubes = 15.
#   S/N threshold for datacubes files, spatial binning 1-3:
sn_thr_tpl_datacubes = 2.
sn_thr_str_datacubes = 2.
sn_thr_ems_datacubes = 2.
# Calibration coefficients for datacubes files. Formula is specified in the mdap_calibrat_sn.pro function.
sn_calibration_datacubes = [1.1,0.743865,1.10317,-0.0106751,4.00892*10.^(-5)]
#
#
weight_for_sn=1
#weight_for_sn=0
#
# -- User supplied binning schemes for the 3 spatial two-dimensional binning.
# Names of fits files specifying the binnin schemes must be provided as string. Fits files must have
# the header keywords CRVAL1, CRVAL2, CDELT1, CDELT2, NAXIS1, NAXIS2, CRPIX1, and CRIX2: 
# Coordinate 0,0 should indicate the center of the field of view
# If these variable are undefined (or the specified fits file is not found, the S/N criteria defined above will be used
# If these variable are defined, the S/N criteria defined above will be ignored
#
# user_bin_map_spatial_binning_1 = root_name + '_bin1.fits'
# user_bin_map_spatial_binning_2 = 'none'
# user_bin_map_spatial_binning_3 = 'none'
#
# -- User supplied binning schemes for the RADIAL BINNING
# If undefined, up to 6 radial bins will be automatically defined.
# String expressions containing 'abin', 'PSFsize', and 'Reff' are allowed as the example below
# abin is the semimajor axis, hardwired variable, computed in mdap_spatial_radial_binning.pro. 
# PSFsize is the size of the PSF (in arcsec). It needs to be provided in the input catalogue (default: 2" if undefined).
# Reff is the effective radius (in arcsec). It needs to be provided in the input catalogue (default: max(abin)/2 if undefined).
low_radial_bins_user_inputs   = ['0.'     , '0.'  ,'Reff'    ,'0.'      ,'Reff'   ,'0.'     ,'1.5*Reff','2.0*Reff']
upper_radial_bins_user_inputs = ['PSFsize', 'Reff','1.5*Reff','1.5*Reff','2.*Reff','2.*Reff','2.0*Reff','max(abin)']
#
# If user bins are specified, you can still append a desired number of bins, log-spaced by setting add_default_bins to an integer value
add_default_bins=15
#
#--------------------------------------------------------------------------------------------
#
# Definition of emission lines and their fitting set-up, for the spatial binning schemes 
# Only those specified in emission_line_file_spatial_binnin_3 will be stored.
# 
emission_line_file_binning_1='./mangadap/external/emission_lines_setup_with_Balmer_decrement_no_doublets'
emission_line_file_binning_2='./mangadap/external/emission_lines_setup_with_Balmer_decrement_no_doublets'
emission_line_file_binning_3='./mangadap/external/emission_lines_setup_with_Balmer_decrement_no_doublets'
emission_line_file_rad_binning='./mangadap/external/emission_lines_setup_with_Balmer_decrement_residuals'
#
#--------------------------------------------------------------------------------------------
#
#--------------------------------------------------------------------------------------------
#

# absorption_line_indices. String specifying the name of the file
# which defines the absorption line indices to measure.
# It must be an ascii file with 9 columns:
#     1. Integer. Unique ID number of the absorption line feature.
#
#     2. String. Unique name of the absorption line feature. This will
#        define the name of the field in sctructure of the DAP results
#        (i.e. the name must begin with a letter, special characters
#        like comas or dots are not allowed).
#
#   3-4. Float (units: ang) Lower and upper value of the index
#        passpand.
#
#   5-6. Float (units: ang) Lower and upper value of the index blue
#        pseudo-continuum.
#
#   7-8. Float (units: ang) Lower and upper value of the index red
#        pseudo-continuum.
#
#     9. String (accepted values are: ang or mag). Specifies the units
#        (ang or magnitudes) of the output.
#
# absorption_line_indices must be defined, and it will be passed to
# the interface mdap_measure_indices.pro and the utility
# mdap_read_indices_definitions.pro via the
# absorption_line_indices input variable.
#
# Indices will be measured only if their blue and red pesudo-continua
# bandpasses are included in the considered wavelength range. If not,
# their values are set to NaN, and their errors to 99 in the final
# output file.
# 
absorption_line_indices='./mangadap/external/absorption_line_indices_definition.dat'
#
#
# -- Saving intermediate steps.
# save_intermediate_steps. If set to 1 at the end of each block
# an idl session with all the current variables is saved. Default: 0 (suggested)
save_intermediate_steps = 1
#
#--- Removal of null templates
# remove_null_templates. If set to 1, the stellar templates that have
# null weight after the fiting of the first spatial bin will be
# rejected from the other fits. It is meaningful only if the libraries
# used for the other spatial binnings are the same of that used for
# the first spatial binning. Default: 0 Suggested value = 1.
#
remove_null_templates = 1
#
#
#-- Path indicating the location of external fortran or C codes. If not specified, internal IDL procedures are used.
 external_library='./mangadap/external/F90_32/'
# external_library='./mangadap/external/F90_64/'
# --------------------------------------------------------------------------------------------
 spectral_fit_par_bin1=['MOMENTS=4','DEGREE=-1','MDEGREE=6']
 spectral_fit_par_bin2_2mns=['MOMENTS=2','DEGREE=3','MDEGREE=6']
 spectral_fit_par_bin2=['MOMENTS=4','DEGREE=3','MDEGREE=6']
 spectral_fit_par_bin3=['MOMENTS=4','DEGREE=3','MDEGREE=6']
 spectral_fit_par_rbin=['MOMENTS=2','DEGREE=-1','mdegree=6','reddening=[0.01]','LAMBDA=exp(loglam_gal)']
 instrumental_fwhm_file='./mangadap/external/instrumental_fwhm.dat'
